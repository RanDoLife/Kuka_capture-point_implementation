<?xml version="1.0"?>

<robot name="egp64_schunk_gripper" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:include filename="$(find kuka_kr3_support)/urdf/egp64_schunk_gripper.transmission.xacro" />
  
  <xacro:property name="camera_parent_link" value="egp64_gripper_base_link" />


  <xacro:macro name="egp64_schunk_gripper" params="prefix parent *origin">

    <!-- ZED2 camera -->
    <!-- <xacro:include filename="$(find kuka_kr3_support)/urdf/camera_gripper.xacro" />  -->

    <link name="egp64_gripper_base_link">
        <inertial>
          <origin xyz="0 0 0" rpy="0 0 0" />
          <mass value="0.005" />
          <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
        </inertial>
        <visual>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - BASE noAdapter.dae" />
          </geometry>
          <material name="blue">
            <color rgba="0 0 1 1"/>
          </material>
        </visual>
        <collision>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - BASE noAdapter.dae" />
          </geometry>
          <material name="blue"/>
        </collision>
    </link>
    
    <joint name="egp64_coupler" type="fixed">
        <parent link="schunk_coupler"/>
        <child link="egp64_gripper_base_link"/>
        <origin xyz="-0.03205 0.01812 0.02047" rpy="0 0 0" />
    </joint>
    
    <!-- LEFT FINGER BASE -->
      
      <link name="egp64_finger_left_link">
        <inertial>
          <origin xyz="0.01483 -0.00782 0" rpy="0 0 0" />
          <mass value="0.002" />
          <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
        </inertial>
        <visual>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - LEFT FINGER BASE.dae" />
          </geometry>
          <material name="black">
            <color rgba="0 0 0 1"/>
          </material>
        </visual>
        <collision>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - LEFT FINGER BASE.dae" />
          </geometry>
          <material name="black" />
        </collision>
      </link>
      
      <joint name="egp64_finger_left_joint" type="prismatic" >
        <parent link="egp64_gripper_base_link" />
        <child link="egp64_finger_left_link" />
        <limit effort="100" lower="-0.001" upper="0.04" velocity="0.2"/>
        <origin xyz="0.01483 -0.00782 0" rpy="0 0 0" />
        <axis xyz="-1 0 0" />
      </joint>
      
      <!-- LEFT FINGERTIP -->
      
      <link name="egp64_fingertip_left_link">
        <inertial>
          <origin xyz="0.03869 -0.0005 0.00093" rpy="0 0 0" />
          <mass value="0.001" />
          <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
        </inertial>
        <visual>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - LEFT FINGER.dae" />
          </geometry>
          <material name="silver">
            <color rgba="0.8 0.8 0.8 1"/>
          </material>
        </visual>
        <collision>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - LEFT FINGER.dae" />
          </geometry>
          <material name="black"/>
        </collision>
      </link>
      
      <joint name="egp64_fingertip_left_joint" type="fixed" >
        <parent link="egp64_finger_left_link" />
        <child link="egp64_fingertip_left_link" />
        <origin xyz="0.03869 -0.0005 0.00093" rpy="0 0 0"/>
      </joint>

      
      <!-- RIGHT FINGER BASE -->

      <link name="egp64_finger_right_link">
        <inertial>
          <origin xyz="-0.0153 -0.00602 0" rpy="0 0 0" />
          <mass value="0.002" />
          <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
        </inertial>
        <visual>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - RIGHT FINGER BASE.dae" />
          </geometry>
          <material name="black"/>
        </visual>
        <collision>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - RIGHT FINGER BASE.dae" />
          </geometry>
          <material name="black"/>
        </collision>
      </link>
      
      <joint name="egp64_finger_right_joint" type="prismatic" >
        <parent link="egp64_gripper_base_link" />
        <child link="egp64_finger_right_link" />
        <limit effort="100" lower="-0.001" upper="0.04" velocity="0.2"/>
        <origin xyz="-0.0153 -0.00602 0" rpy="0 0 0" />
        <axis xyz="1 0 0" />
      </joint>
      
      <!-- RIGHT FINGERTIP -->

      <link name="egp64_fingertip_right_link">
        <inertial>
          <origin xyz="-0.01211 -0.00197 0.00093" rpy="0 0 0" />
          <mass value="0.001" />
          <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
        </inertial>
        <visual>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - RIGHT FINGER.dae" />
          </geometry>
          <material name="silver" />
        </visual>
        <collision>
          <geometry>
            <mesh filename="file://$(find kuka_kr3_support)/meshes/egp64/Schunk Gripper - RIGHT FINGER.dae" />
          </geometry>
          <material name="black"/>
      </collision>
      </link>
      
      <joint name="egp64_fingertip_right_joint" type="fixed" >
        <parent link="egp64_finger_right_link" />
        <child link="egp64_fingertip_right_link" />
        <origin xyz="-0.01211 -0.00197 0.00093" rpy="0 0 0"/>
      </joint>

      <!-- SMALL CUBE FOR GRIPPER PLUGIN 

      <link name="EE_egp64">
        <inertial>
          <origin xyz="0 0 0" rpy="0 0 0" />
          <mass value="0.00001" />
          <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
        </inertial>
        <visual>
          <geometry>
            <box size= "0.001 0.001 0.001" />
          </geometry>
        </visual>
      </link>
      
      <joint name="EE_egp64_joint" type="prismatic" >
        <parent link="egp64_gripper_base_link" />
        <child link="EE_egp64" />
        <limit effort="10000" lower="0.0" upper="0.0" velocity="0.0"/>
        <axis xyz="1 0 0" />
        <origin xyz="0.033 -0.018 0.15" rpy="0 0 0"/>
      </joint>-->
    
   
    
    <!-- Improve grasping physics -->
    <gazebo reference="egp64_fingertip_left_joint">
      <kp>1000000.0</kp>
      <kd>1.0</kd>
      <mu1>1.0</mu1>
      <mu2>1.0</mu2>
      <minDepth>0.001</minDepth>
    </gazebo>
    <gazebo reference="egp64_fingertip_right_joint">
      <kp>1000000.0</kp>
      <kd>1.0</kd>
      <mu1>1.0</mu1>
      <mu2>1.0</mu2>
      <minDepth>0.001</minDepth>
    </gazebo>
    
    <xacro:egp64_schunk_gripper_transmission prefix="" />

  </xacro:macro>
</robot>
